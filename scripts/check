#!/usr/bin/escript

main(Args) ->
    net_kernel:start(master, #{name_domain => shortnames}),
    % TODO I had to set this table to public, so the other nodes can access it,
    % which in theory could be exploited, although it's pretty unlikely
    ets:new(stat, [named_table, public, set, {keypos, 1}]),
    ets:insert(stat, {counts, []}),
    case Args of
        ["db"]     ->
            debugger:quick(check_equiv, check_equiv, ["master^", "master"]);
        ["stats"]  ->
            {Res, Failed} = check_equiv:check_equiv("master^", "master"),
            utils:statistics(),
            NumOfFail = length(Failed),
            NumOfSuccess = length(Res),
            io:format("~p failed out of ~p~n", [NumOfFail, NumOfSuccess]);
        _Otherwise ->
            Res = check_equiv:check_equiv("master^", "master"),
            utils:show_result(Res)
    end,
    ets:delete(stat).
